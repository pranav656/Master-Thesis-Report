\chapter{Experimentations with SLM}
\label{chp:SLM}
\section{Initial Experiments to image mask}
I started off the experiment with the setup mentioned in the previous section. However, when trying to take an image of the mask with the CMOS sensor, I faced multiple challenges along the  way. The first challenge came in the form of the memory limitations of the camera module. The OV2640 camera module has only 384KB of memory which can store compressed JPEG images when imaging with lens. The memory limitation of the camera does not come into effect when imaging with lens as JPEG encoding is naturally designed for reducing size of real life artifacts and object scenes with a very high compression ratio. However, when using the same camera module, for lensless imaging, the size of the image easily exceeds the size of the FIFO buffer and the host software provided by the vendor is unable to read out the images. In order to overcome this challenge, I thought of increasing the extent of compression(with a trade-off of loss in quality) to image of the mask. This can be done by changing the \texttt{QSC} register(quantization scale factor) \cite{} of the CMOS sensor. The default value of the quantization scale factor is \texttt{0C}(hex value). This value was increased to \texttt{2F} by setting the registers using I2C as mentioned for the previous acceptance cone experiments. The size of the image was successfully reduced and the host software was able to read out images. After this the sensor was placed in front of the SLM and the experiments were continued. I started experimenting with the default masks provided by the SLM vendor before continuing onto the custom mask designed using simulations. The mask that was used was a binary axicon mask and binary mask which divides the SLM into two different halves.The figure of the mask is shown in Figure \ref{fig:InitMask}. The white portion of the horizontal mask is not visible.

After overcoming this challenge I faced the second challenge wherein, the mask was not visible and the central part of the sensor had saturated(whited out). This can be seen in Figure \ref{fig:InitMaskCMOS}. It can be seen from Figure \ref{fig:InitMaskCMOS} that the binary axicon mask is not at all visible due to the saturation of the CMOS sensor in the central region. The horizontal mask is imaged as a vertical mask by the CMOS sensor as the SLM is oriented vertically against the CMOS sensor. Even in the horizontal mask, the central portion has saturated. 

\begin{figure}[h]
    \centering
    \begin{subfigure}{0.5\textwidth}
    \centering
        \includegraphics[width=0.5\linewidth]{pics/slm/binaryaxicon.png}
        \caption{Binary Axicon Mask}
        \label{fig:axiconmask}
    \end{subfigure}%
    \begin{subfigure}{0.5\textwidth}
    \centering
        \includegraphics[width=0.5\linewidth]{pics/slm/hor-div.png}
        \caption{Horizontal dividable mask}
        \label{fig:hordivmask}
    \end{subfigure}
    \caption{Binary Masks used for Test}
    \label{fig:InitMask}
    \end{figure}
    
    \begin{figure}[h]
    \centering
    \begin{subfigure}{0.5\textwidth}
    \centering
        \includegraphics[width=0.5\linewidth]{pics/slm/binaryaxiconcmos.jpg}
        \caption{Binary Axicon Mask imaged by CMOS}
        \label{fig:binaryaxiconcmos}
    \end{subfigure}%
    \begin{subfigure}{0.5\textwidth}
    \centering
        \includegraphics[width=0.5\linewidth]{pics/slm/horizontalcmos.jpg}
        \caption{Horizontal dividable mask imaged by CMOS}
        \label{fig:hordivmask}
    \end{subfigure}
    \caption{Binary Masks used for Test}
    \label{fig:InitMaskCMOS}
    \end{figure}
In order to solve these problems, multiple changes were made to the way the experiment was conducted. To avoid saturation, the exposure time of the CMOS sensor was reduced to the lease possible value(70 $\mu$seconds). Since, this did not affect the image of the mask formed on the sensor, it was decided to change the brightness and contrast levels of the SLM itself. The transmissive SLM acts as a screen and thus it has it's own brightness and contrast levels that affect the amount of light reaching the sensor. So, I decided to study the effect of the brightness and contrast on the image sensor. Also, two n.d filters were added to the setup that cut the intensity of light reaching the sensor by 75 percent. The SLM was placed approximately at a distance of 1 cm(10 mm) from the mask for these experiments.
\section{Effect of SLM brightness and contrast on CMOS sensor}
The first set of experiments was conducted to see the effect of brightness and contrast of the SLM on the image formed by the CMOS sensor. For this I thought of illuminating the CMOS sensor using the laser beam and then study the output image from the CMOS sensor for different gray levels on the CMOS sensor. Three gray levels(0,128,255) were chosen and the brightness/contrast levels were varied to see which brightness/contrast levels best represent the amount of light propotional to the grayness levels of the SLM. The brightness/contrast levels could be varied from 0 to 64 on the SLM. All the readings were normalized with respect to 255 to see how the intensity drops with respect to grayness levels. It can be seen from figures \ref{fig:slm_grayscale0},\ref{fig:slm_grayscale128},\ref{fig:slm_grayscale255} that there is a certain level of drop in intensity signal irrespective of the brightness levels. However, it is only in some gray levels that the drop is significant and noticeable(>25 percent reduction in intensity). The attenuation factors(ratio of reduction in intensity with respect to gray level 0) is plotted in tables \ref{tbl:attenuation128},\ref{tbl:attenuation255} that brightness levels and contrast levels close to 60 provide maximum attenuation in signals for graylevels 128(around 28 percent reduction) and gray levels 255(around 88 percent reduction) gray levels. It was decided to set the brightness and contrast values to 63 and study how the grayness level of the SLM affects the amount of light passing through the SLM.
\begin{figure}[h]
\centering
\includegraphics[scale=0.35]{pics/slm/slmgrayscale0.jpg}
\caption{Effect of brightness and contrast on intensity for grayscale 0}
\label{fig:slm_grayscale0}
\end{figure}
\begin{figure}[h]
\centering
\includegraphics[scale=0.35]{pics/slm/slmgrayscale128.jpg}
\caption{Effect of brightness and contrast on intensity for grayscale 128}
\label{fig:slm_grayscale128}
\end{figure}

\begin{figure}[htbp]
\centering
\includegraphics[scale=0.35]{pics/slm/slmgrayscale255.jpg}
\caption{Effect of brightness and contrast on intensity for grayscale 255}
\label{fig:slm_grayscale255}
\end{figure}

\begin{center}
\begin{table}[!h]
\begin{tabular}{|l|*{8}{c|}}\hline
\backslashbox{B}{C}
&\makebox[3em]{0}&\makebox[3em]{10}&\makebox[3em]{20}&\makebox[3em]{30}
&\makebox[3em]{40}&\makebox[3em]{50}&\makebox[3em]{60}&\makebox[3em]{63}\\\hline
\makebox[3em]{0} &0.9462&0.9669&1.2788&1.2455&0.9471&1.1301&0.8830&0.8875\\\hline
\makebox[3em]{10}&0.9537&0.9792&1.2639&1.2326&0.9206&0.8663&	0.7717&0.6853\\\hline
\makebox[3em]{20}& 0.9618&0.9717&1.2542&1.7043&0.9146&0.8726&0.8941&0.7327\\\hline
\makebox[3em]{30}&0.9622&0.9712&1.2600&1.2353&0.9266&0.9862&	0.7416&0.8852\\\hline
\makebox[3em]{40} &0.9731&0.9689&1.2625&0.9466&0.9127&0.8347&	0.7390&0.7205\\\hline
\makebox[3em]{50} &0.9593&0.9696&1.2597&0.9499&0.9145&0.8351&0.74525&0.7149\\\hline
\makebox[3em]{60} &0.9745&0.9634&1.2467&1.2331&0.9172&0.8288&	0.7433&0.7159\\\hline
\makebox[3em]{63}&0.9745&1.2669&1.233&1.2286&0.9121&0.8318&0.7394&0.7221\\\hline
\end{tabular}
\caption{Attenuation Factors of gray level 128 with respect to gray level 0 for different brightness and contrast levels}
\label{tbl:attenuation128}
\end{table}
\end{center}


\begin{center}
\begin{table}[!h]
\begin{tabular}{|l|*{8}{c|}}\hline
\backslashbox{B}{C}
&\makebox[3em]{0}&\makebox[3em]{10}&\makebox[3em]{20}&\makebox[3em]{30}
&\makebox[3em]{40}&\makebox[3em]{50}&\makebox[3em]{60}&\makebox[3em]{63}\\\hline
\makebox[3em]{0} &0.9834&0.9941&1.3247&1.2975&0.9602&1.0882&	0.81991&0.8124\\\hline
\makebox[3em]{10}&0.9971&1.0161&1.2988&1.2161&0.8096&0.5931&	0.4336&0.3780\\\hline
\makebox[3em]{20}& 1.011&0.9831&1.2162&1.5084&0.5896&0.3460&	0.2686&0.2113\\\hline
\makebox[3em]{30}&0.9966&0.9647&1.1133&0.8718&0.3898&0.2200&0.16253&0.1946\\\hline
\makebox[3em]{40} &0.9841&0.9138&0.9454&0.4592&0.2239&0.1554&0.1627&0.14317\\\hline
\makebox[3em]{50} &0.9350&0.7867&0.6462&0.2665&0.1593&0.1420&0.1296&0.1356\\\hline
\makebox[3em]{60} &0.8626&0.6265&0.3937&0.2237&0.1418&0.1345&0.1327&0.1291\\\hline
\makebox[3em]{63}&0.8188&0.7389&0.3334&0.2104&0.1375&0.1323&0.1385&0.1293\\\hline
\end{tabular}
\caption{Attenuation Factors of gray level 255 with respect to gray level 0 for different brightness and contrast levels}
\label{tbl:attenuation255}
\end{table}
\end{center}

\section{Effect of gray levels on CMOS sensor}
From the experimental results mentioned in the previous section, it can be seen that the maximum brightness and contrast levels of the SLM provide the maximum attenuation in signals. So, these values were chosen and the grayness levels of the SLM was varied from 0 to 255 and study how the grayness levels affect the amount of light passing through the SLM. The entire SLM screen is set to this grayness level so that the entire sensor is modulated with the same intensity of light.
The mean of the entire output image of the CMOS sensor is taken for plotting the signal and it is normalized with respect to the maximum reading and the graph is plotted. This is shown in figure \ref{fig:grayscale_slm_graph}. As it can be seen in the graph, the lowest point corresponds to an intensity reduction of approximately 88 percent. One important observation is that it is not possible to create a completely binary mask which blocks light as the maximum intensity reduction is only 88 percent. This will have an effect on the image reconstruction as it is assumed that the mask is completely binary. 

\begin{figure}[!htbp]
\centering
\includegraphics[scale=0.35]{pics/slm/grayscale_slm_graph.jpg}
\caption{Grayscale vs intensity of light received by the CMOS sensor.}
\label{fig:grayscale_slm_graph}
\end{figure}
